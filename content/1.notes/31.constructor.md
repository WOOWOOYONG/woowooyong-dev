---
title: 'JavaScript-æ§‹é€ å‡½å¼'
description: 'é—œæ–¼Constructor Functionå’ŒClass'
date: '2024-01-10'
category: 'JavaScript'
tags:
  - JavaScript
  - Constructor
  - Class
---

# æ§‹é€ å‡½å¼

## ç°¡ä»‹

- å¦‚æœä»Šå¤©è¦å»ºç«‹ä¸€å€‹ user ç‰©ä»¶å¦‚ä¸‹
- ä»¥é€™ç¨®å¯«æ³•å‰µå»ºçš„ç‰©ä»¶ï¼Œç¨±ä½œå¯¦å­—ç‰©ä»¶ (Object literal)

```js
const user = {
    name: 'Andy',
    gender: 'male'
    age: 30,
    hello: function() {
        console.log('say hello')
    }
}

```

- ä½†å¦‚æœè¦å»ºç«‹å¾ˆå¤šçš„ user ç‰©ä»¶ï¼Œé€™æ¨£çš„æ–¹æ³•é¡¯ç„¶æ˜¯å¾ˆæ²’æœ‰æ•ˆç‡çš„
- æˆ‘å€‘éœ€è¦å‰µå»ºä¸€å€‹æ¨¡æ¿é¡å‹ï¼Œä¾†å¤§é‡å»ºç«‹é¡ä¼¼çš„ç‰©ä»¶

## å¦‚ä½•å‰µå»º

- å‘½åé€šå¸¸ä»¥å¤§å¯«å­—æ¯é–‹é ­
- åªèƒ½ç”± new é—œéµå­—ä¾†åŸ·è¡Œ
- ä½¿ç”¨ new é—œéµå­—åŸ·è¡Œå‡½å¼çš„è¡Œç‚ºè¢«ç¨±ç‚ºå¯¦ä¾‹åŒ–
- å¯¦ä¾‹åŒ–æ§‹é€ å‡½å¼æ™‚æ²’æœ‰åƒæ•¸å¯ä»¥çœç•¥`()`
- å…§éƒ¨ä¸ç”¨å¯« returnï¼Œå›å‚³å€¼å°±æ˜¯æ–°å»ºç«‹çš„ç‰©ä»¶
- åœ¨å¯¦ä¾‹æ–¹æ³•ä¸­ï¼Œ`this`å°±è¡¨ç¤ºç•¶å‰çš„å¯¦ä¾‹

**ç¯„ä¾‹**

- æ¯å€‹ user éƒ½æœ‰`name`, `gender`, `age`
- é€™äº›æ˜¯é€™å€‹é¡åˆ¥çš„å±¬æ€§(properties)

```js
function User(name, gender, age) {
  // properties
  this.name = name
  this.gender = gender
  this.age = age
}

const jerry = new User('Jerry', 'female', 18)
const tom = new User('Tom', 'male', 22)
```

- æ§‹é€ å‡½å¼å»ºç«‹çš„ç‰©ä»¶å½¼æ­¤ç¨ç«‹ï¼Œä½”æ“šçš„è¨˜æ†¶é«”ä½ç½®ä¸åŒ
- è‹¥è¦åœ¨é¡åˆ¥ä¸­å®šç¾©å…¬ç”¨çš„æ–¹æ³•ï¼Œä¸æ¨è–¦åœ¨ function å…§å®šç¾©
- ä¾‹å¦‚æ¯å€‹ user éƒ½è¦æœ‰ä¸€å€‹`hello`æ–¹æ³•

**ç¯„ä¾‹ 1ï¼šä½¿ç”¨ this åœ¨ constructor function å…§å‰µå»º**

```js
function User(name, gender, age) {
  // properties
  this.name = name
  this.gender = gender
  this.age = age

  // method
  this.hello = function () {
    console.log('say hello')
  }
}

const jerry = new User('Jerry', 'female', 18)
const tom = new User('Tom', 'male', 22)

// ä»¥ä¸‹éƒ½æ˜¯ä¸€æ¨£çš„æ–¹æ³•ï¼Œå¾—åˆ°ç›¸åŒçš„çµæœ
// å»ä½”äº†å…©å€‹è¨˜æ†¶é«”ä½ç½® ğŸ˜“
jerry.hello()
tom.hello()
```

**ç¯„ä¾‹ 2ï¼šä½¿ç”¨ prototype**

- å°‡å…±ç”¨çš„æ–¹æ³•ï¼Œæ”¾åˆ°`prototype`ä¸­
- åœ¨å‘¼å«ç‰©ä»¶çš„æ–¹æ³•æ™‚ï¼ŒJavaScript æœƒé€éåŸå‹éˆå°‹æ‰¾è©²æ–¹æ³•æ˜¯å¦å­˜åœ¨
- æ‰€ä»¥å°‡æ–¹æ³•æ”¾å…¥ constructor çš„åŸå‹è£¡ï¼Œæ¯å€‹ç‰©ä»¶å¯¦ä¾‹éƒ½å¯ä»¥ä½¿ç”¨

```js
function User(name, gender, age) {
  // properties
  this.name = name
  this.gender = gender
  this.age = age
}

// method
User.prototype.hello = function () {
  console.log('say hello')
}

// å¾åŸå‹éˆæ‰¾åˆ° ğŸ‘ğŸ¼
const andy = new User('Andy', 'male', '30')
andy.hello() // say hello
```

- é›–ç„¶`andy`é€™å€‹ç‰©ä»¶ä¸­ï¼Œæ²’æœ‰`hello`ï¼Œä½†å¾åŸå‹éˆ(prototype)ä¸­ï¼Œå¯ä»¥æ‰¾åˆ°è©²æ–¹æ³•ä¸¦å‘¼å«

::MdImg{img-src= "/images/notes/prototype-1.png" width="w-[500px]"}
::

## Class

- åœ¨ ES6 åŠ å…¥çš„æ–°èªæ³•
- ç”¨ä¾†ç°¡åŒ– constructor function çš„èªæ³•ç³–

```js
class Car {
  constructor(brand, color) {
    this.brand = brand
    this.color = color
  }
  accelerate() {
    console.log('å¯ä»¥åŠ é€Ÿ')
  }
}

const myCar = new Car('Ferrari', 'red')
myCar.accelerate() // å¯ä»¥åŠ é€Ÿ
```

### Getter & Setter

- ç•¶æƒ³æ”¹è®Šç‰©ä»¶å…§çš„å€¼æ™‚ï¼Œä¸€èˆ¬å¯«æ³•å¦‚ä¸‹

```js
class Car {
  constructor(brand, color) {
    this.brand = brand
    this.color = color
  }
}

const myCar = new Car('Mazeda', 'White')
console.log(myCar) // { brand: 'Mazeda', color: 'White'}
myCar.color = 'Yellow'
console.log(myCar) // { brand: 'Mazeda', color: 'Yellow' }
```

**å•é¡Œ**

- ä½†å¦‚æœæƒ³é™åˆ¶`brand`å’Œ`color`ä¸èƒ½æ˜¯ç©ºå­—ä¸²ï¼Œä»¥ä¸Šæ–¹æ³•æ²’è¾¦æ³•å¹«æˆ‘å€‘é©—è­‰

**æ”¹å–„æ–¹æ³•**

- åœ¨é—œéµå­—`get`, `set`å¾Œé¢åŠ ä¸Šå±¬æ€§åç¨±ï¼Œå®šç¾©å°æ‡‰çš„`getter`å’Œ`setter`
- åœ¨`setter`ä¸­ï¼Œå¯ä»¥åŠ ä¸Šè‡ªå®šç¾©çš„é‚è¼¯ï¼Œä¾‹å¦‚é©—è­‰æˆ–æ ¼å¼åŒ–ï¼Œç•¶å±¬æ€§çš„å€¼æ”¹è®Šæ™‚è§¸ç™¼
- å°æ–¼åªæœ‰å€åŸŸå…§å¯ä»¥å­˜å–åˆ°çš„è®Šæ•¸ï¼Œé€šå¸¸ä»¥ `_` é–‹é ­ä¾†å‘½å

```js
class Car {
  constructor(brand, color) {
    this._brand = brand
    this._color = color
  }

  // Getter for 'brand'
  get brand() {
    return this._brand
  }

  // Setter for 'brand'
  set brand(value) {
    if (value.length > 0) {
      this._brand = value
    }
  }

  // Getter for 'color'
  get color() {
    return this._color
  }

  // Setter for 'color'
  set color(value) {
    if (value.length > 0) {
      this._color = value
    }
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const myCar = new Car('Toyota', 'Red')
console.log(myCar.brand) // Toyota
console.log(myCar.color) // Red

myCar.brand = 'Honda'
myCar.color = 'Blue'
console.log(myCar.brand) // Honda
console.log(myCar.color) // Blue
```

### extends

- æ˜¯ä¸€å€‹ç”¨æ–¼é¡ï¼ˆclassï¼‰ç¹¼æ‰¿çš„é—œéµå­—
- ç”¨æ–¼å‰µå»ºä¸€å€‹å­é¡ï¼Œç¹¼æ‰¿äº†çˆ¶é¡çš„æ‰€æœ‰å±¬æ€§å’Œæ–¹æ³•
- å¦‚æœå­é¡æ²’æœ‰å®šç¾©è‡ªå·±çš„æ§‹é€ å‡½æ•¸ï¼Œå‰‡æœƒèª¿ç”¨çˆ¶é¡çš„æ§‹é€ å‡½æ•¸
- åœ¨å­é¡çš„æ§‹é€ å‡½æ•¸ä¸­ï¼Œå¿…é ˆä½¿ç”¨ `super()` ä¾†èª¿ç”¨çˆ¶é¡çš„æ§‹é€ å‡½æ•¸
- å­é¡å¯ä»¥é‡å¯«ç¹¼æ‰¿è‡ªçˆ¶é¡çš„æ–¹æ³•

```js
// çˆ¶é¡
class Vehicle {
  constructor(brand) {
    this.brand = brand
  }

  start() {
    console.log(`${this.brand} vehicle is starting.`)
  }
}

// å­é¡
class Car extends Vehicle {
  constructor(brand, model) {
    super(brand) // èª¿ç”¨çˆ¶é¡çš„æ§‹é€ å‡½æ•¸
    this.model = model
  }

  start() {
    super.start() // èª¿ç”¨çˆ¶é¡çš„æ–¹æ³•
    console.log(`${this.brand} ${this.model} is ready to go!`)
  }
}

const myCar = new Car('Toyota', 'Corolla')
myCar.start()
// è¼¸å‡º: Toyota vehicle is starting.
//       Toyota Corolla is ready to go!
```

### static

- åœ¨ class ä¸Šå®šç¾©éœæ…‹å±¬æ€§å’Œæ–¹æ³•
- éœæ…‹æ–¹æ³•å’Œå±¬æ€§ï¼Œå±¬æ–¼ class æœ¬èº«
- ä¸éœ€è¦å‰µå»ºå¯¦ä¾‹ä¾†èª¿ç”¨éœæ…‹æ–¹æ³•å’Œå±¬æ€§

```js
class MathUtility {
  // éœæ…‹æ–¹æ³•
  static sum(a, b) {
    return a + b
  }

  // éœæ…‹å±¬æ€§
  static pi = 3.14159
}

// èª¿ç”¨éœæ…‹æ–¹æ³•
console.log(MathUtility.sum(10, 5)) // è¼¸å‡º: 15

// è¨ªå•éœæ…‹å±¬æ€§
console.log(MathUtility.pi) // è¼¸å‡º: 3.14159
```

### Public Class Fields

- åœ¨æ‰€æœ‰å¯¦ä¾‹ä¸Šéƒ½å¯ä»¥å–å¾—çš„å±¬æ€§æˆ–æ–¹æ³•
- å¯ä»¥ç›´æ¥è¢«ä¿®æ”¹

```js
class Car {
  color = 'Pink'

  constructor(brand) {
    this.brand = brand
  }
}

const myCar = new Car('Nissan')
// å¯ä»¥ç›´æ¥æ”¹myCarçš„colorå’Œbrand
myCar.color = 'Green'
myCar.brand = 'Ford'
console.log(myCar) // { color: 'Green', brand: 'Ford' }
```

### Private Class Fields

- åªèƒ½åœ¨ class å…§è¢«è¨ªå•çš„è®Šæ•¸æˆ–æ–¹æ³•
- ä»¥`#`é–‹é ­ï¼Œè¡¨ç¤ºæ˜¯ç§æœ‰çš„

```js
class BankAccount {
  #balance // å¸³æˆ¶é¤˜é¡

  constructor(initialBalance) {
    this.#balance = initialBalance // åˆå§‹åŒ–é¤˜é¡
  }

  deposit(amount) {
    if (amount > 0) {
      this.#balance += amount
      console.log(`å­˜å…¥ ${amount}ã€‚ç•¶å‰é¤˜é¡ï¼š${this.#balance}`)
    }
  }

  withdraw(amount) {
    if (amount <= this.#balance) {
      this.#balance -= amount
      console.log(`æå– ${amount}ã€‚ç•¶å‰é¤˜é¡ï¼š${this.#balance}`)
    } else {
      console.log('é¤˜é¡ä¸è¶³ï¼Œç„¡æ³•æå–ï¼')
    }
  }

  getBalance() {
    return this.#balance // æä¾›å…¬é–‹æ–¹æ³•ä¾†ç²å–é¤˜é¡
  }
}

// ä½¿ç”¨ç¯„ä¾‹
const myAccount = new BankAccount(1000)
myAccount.deposit(500) // å­˜å…¥ 500
myAccount.withdraw(200) // æå– 200
console.log(`å¸³æˆ¶é¤˜é¡ï¼š${myAccount.getBalance()}`) // æŸ¥è©¢é¤˜é¡

// ç›´æ¥è¨ªå• #balance æœƒæœ‰éŒ¯èª¤
console.log(myAccount.#balance) // SyntaxError
```

## åƒè€ƒè³‡æ–™

- [JavaScript ç‰©ä»¶å°å‘ï½œ Alphacamp](https://javascript.alphacamp.co/basic-idea-of-oo.html)
- [JavaScript é¡åˆ¥ï¼ˆClassï¼‰](https://pjchender.dev/javascript/js-class/#public-class-fields)
- [Inheritance in JavaScript - Prototypal Inheritance tutorial](https://www.youtube.com/watch?v=jnME98ckDbQ&list=PL1PqvM2UQiMoGNTaxFMSK2cih633lpFKP&index=1)
- [javascript.info](https://javascript.info/class)
